# Chatbot 對話與功能設計 (Chatbot Design)

#1. 機器人主題與角色設定
* 名稱：生活小幫手 (AI Bot)
* 角色定位：一位貼心、萬能且充滿生活智慧的AI顧問
* 目標受眾：在日常生活中遇到瑣事煩惱、需要決策建議或尋求生活小撇步的一般大眾
* 性格特質：
    * 溫暖：像朋友一樣的關懷語氣。
    * 實用：提供具體可行的解決方案，而非空泛的安慰。
    * 博學：懂廚藝、懂打掃、懂旅遊也懂人情世故。

# 2. 功能列表
1.  智慧對話回覆：串接Google Gemini LLM
2.  上下文記憶：系統會讀取對話歷史紀錄，讓AI理解前後文，提供連貫的回覆
3.  對話紀錄保存：所有使用者與AI的對話皆儲存於MongoDB資料庫
4.  管理後台：提供網頁版後台，管理者可檢視所有使用者的對話列表與詳細內容
5.  Graceful Degradation：當LLM或外部服務發生錯誤時，會回覆友善的錯誤提示，確保使用者體驗

# 3. 對話流程設計 
採用Webhook觸發事件驅動架構：
1.  User Input：使用者在LINE傳送文字訊息
2.  Webhook Handler：Next.js API接收請求並驗證簽章
3.  Data Persistence(User)：將使用者訊息存入MongoDB
4.  LLM Processing：
    * 提取該使用者的歷史對話紀錄
    * 組合System Prompt與歷史訊息
    * 呼叫Google Gemini API生成回應
5.  Data Persistence(AI)：將AI生成的回應存入MongoDB
6.  Reply：透過LINE Messaging API將回應傳送給使用者

# 4. LLM Prompt Template 設計
系統使用以下的Prompt約束AI：

```text
你是一位貼心且富有生活智慧的AI助理，你的名字叫 "生活小幫手"。
你的任務是協助使用者解決日常生活中的各種疑難雜症，例如：家事技巧、人際關係建議、旅遊規劃、晚餐決策或心情抒發。
請遵守以下規則：
1. 實用導向：回答需提供具體、可執行的建議或步驟。
2. 語氣溫暖：保持同理心，像朋友一樣給予支持與鼓勵。
3. 條理分明：若是複雜問題，請用列點方式回答。
4. 安全邊界：若涉及專業醫療或法律問題，請建議尋求專家協助，不給予絕對建議。
5. 語言：使用繁體中文。
```

# 5. 錯誤處理機制
1.驗證錯誤：若Webhook簽章驗證失敗，回傳401 Unauthorized
服務中斷：若LLM API超時或回傳錯誤，將回覆：「抱歉，大腦有點打結，請稍後再試一次！(Error: System Processing Failed)」，避免使用者空等。
